version: 0.1.{build}

image: Visual Studio 2019

environment:
  matrix:
    - generator: '"Visual Studio 14 2015 Win64"'
      build_type: Debug
    - generator: '"Visual Studio 14 2015 Win64"'
      build_type: Release
    - generator: '"Visual Studio 14 2015 Win64"'
      build_type: Debug
    - generator: '"Visual Studio 14 2015 Win64"'
      build_type: Release
    - generator: '"Visual Studio 15 2017 Win64"'
      build_type: Debug
    - generator: '"Visual Studio 15 2017 Win64"'
      build_type: Release
    - generator: '"Visual Studio 16 2019"'
      build_type: Debug
    - generator: '"Visual Studio 16 2019"'
      build_type: Release

build_script:
  - ps: >-
      mkdir C:\sysroot

      mkdir build

      cd build

      cmake .. -G "$env:generator" -DCMAKE_BUILD_TYPE=$env:build_type -DCMAKE_INSTALL_PREFIX=c:\sysroot

      cmake --build . --config $env:build_type

      cmake --build . --target install

# after_build:
#   - ps: 7z a .\%APPVEYOR_PROJECT_NAME%-%generator%-%BUILD_TYPE%.zip C:\sysroot\*

artifacts:
  - path: .\*.zip
    type: zip

skip_commits:
  message: /\[ci skip\]/